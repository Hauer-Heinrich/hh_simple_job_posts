<html xmlns:f="http://typo3.org/ns/TYPO3/CMS/Fluid/ViewHelpers"
    xmlns:ttaddr="http://typo3.org/ns/FriendsOfTYPO3/TtAddress/ViewHelpers"
    data-namespace-typo3-fluid="true">

<f:layout name="Default" />

<f:section name="content">
    <f:flashMessages />

    <f:if condition="{jobpost}">
        <f:then>
            <div class="jobpost job-offer">
                <f:variable name="datePosted"><f:spaceless>
                    <f:if condition="{jobpost.starttime}">
                        <f:then><f:format.date format="Y-m-d">{jobpost.starttime}</f:format.date></f:then>
                        <f:else><f:format.date format="Y-m-d">{jobpost.crdate}</f:format.date></f:else>
                    </f:if>
                </f:spaceless></f:variable>

                <f:asset.script identifier="jobPosts" additionalAttributes="{type: 'application/ld+json'}">
                    {<f:comment></f:comment>
                        "@context" : "https://schema.org/",
                        "@type" : "JobPosting",

                        "title" : "{jobpost.title}",
                        "description" : "{jobpost.description -> f:format.html()}",

                        "datePosted" : "{datePosted}",
                        "validThrough" : "{f:format.date(date: '{jobpost.endtime}', format: 'Y-m-d')}",

                        "employmentType": "{jobpost.employmentType}",

                        "hiringOrganization" : {<f:comment></f:comment>
                            "@type" : "Organization",
                            "name" : "{jobpost.hiringOrganization.company}",
                            "sameAs" : "{jobpost.hiringOrganization.www}",
                            "logo" : "<f:if condition='{jobpost.hiringOrganization.image}'>{f:uri.image(src: '{jobpost.hiringOrganization.image.0.uid}', treatIdAsReference: 1)}</f:if>"
                        },

                        <f:if condition="{jobpost.baseSalaryValue}">
                            "baseSalary": {
                                "@type": "MonetaryAmount",
                                "currency": "{jobpost.baseSalaryCurrency}",
                                "value": "{jobpost.baseSalaryValue}"
                            },
                        </f:if>

                        "applicationContact": {
                            "@type": "ContactPoint",
                            "email": "info@example.com"
                        }

                        "educationRequirements": "",
                        "experienceRequirements": "",
                        "jobBenefits": "{jobpost.weprovide -> f:format.html()}",

                        <f:if condition="{jobpost.workHours}">
                            "workHours": "{jobpost.workHours}",
                        </f:if>

                        "identifier": {
                            "@type": "PropertyValue",
                            "name": "joboffer",
                            <f:comment></f:comment>"value": "{jobpost.uid}-{datePosted}-{jobpost.hiringOrganization.company}"
                        }
                    }
                </f:asset.script>

                <f:debug title="jobpost" inline="0">{_all}</f:debug>

                <h1>{jobpost.title}</h1>

                <f:if condition="{jobpost.description}">
                    <div class="frame frame-default description">
                        <f:format.html>{jobpost.description}</f:format.html>
                    </div>
                </f:if>

                <f:if condition="{jobpost.maintasks}">
                    <div class="frame frame-default maintasks">
                        <p><f:translate key="LLL:EXT:hh_simple_job_posts/Resources/Private/Language/locallang_fe.xlf:detail.maintasks" /></p>
                        <f:format.html>{jobpost.maintasks}</f:format.html>
                    </div>
                </f:if>

                <f:if condition="{jobpost.profile}">
                    <div class="frame frame-default profile">
                        <p><f:translate key="LLL:EXT:hh_simple_job_posts/Resources/Private/Language/locallang_fe.xlf:detail.profile" /></p>
                        <f:format.html>{jobpost.profile}</f:format.html>
                    </div>
                </f:if>

                <f:if condition="{jobpost.weprovide}">
                    <div class="frame frame-default weprovide">
                        <p><f:translate key="LLL:EXT:hh_simple_job_posts/Resources/Private/Language/locallang_fe.xlf:detail.weprovide" /></p>
                        <f:format.html>{jobpost.weprovide}</f:format.html>
                    </div>
                </f:if>

                <f:if condition="{jobpost.others}">
                    <div class="frame frame-default others">
                        <f:format.html>{jobpost.others}</f:format.html>
                    </div>
                </f:if>

                <f:if condition="{jobpost.hiringOrganization}">
                    <div itemscope itemtype="https://schema.org/LocalBusiness" class="hiringOrganization">
                        <f:if condition="{jobpost.hiringOrganization.www}">
                            <f:then>
                                <a itemprop="url" href="{jobpost.hiringOrganization.www}">
                                    <span itemprop="name">{jobpost.hiringOrganization.company}</span>
                                </a>
                            </f:then>
                            <f:else>
                                <span itemprop="name">{jobpost.hiringOrganization.company}</span>
                            </f:else>
                        </f:if>

                        <f:if condition="{jobpost.hiringOrganization.description}">
                            <span itemprop="description">{jobpost.hiringOrganization.description}</span>
                        </f:if>

                        <div itemprop="address" itemscope itemtype="https://schema.org/PostalAddress">
                            <f:if condition="{jobpost.hiringOrganization.description}">
                                <span itemprop="addressRegion">{jobpost.hiringOrganization.description}</span>
                            </f:if>
                            <f:if condition="{jobpost.hiringOrganization.address}">
                                <span itemprop="streetAddress">{jobpost.hiringOrganization.address}</span><br />
                            </f:if>

                            <f:if condition="{jobpost.hiringOrganization.zip} || {jobpost.hiringOrganization.city}">
                                <span class="city">
                                    <f:if condition="{jobpost.hiringOrganization.zip}">
                                        <span itemprop="postalCode">{jobpost.hiringOrganization.zip}</span>
                                    </f:if>
                                    <f:if condition="{jobpost.hiringOrganization.city}">
                                        <span itemprop="addressLocality">{jobpost.hiringOrganization.city}</span>
                                    </f:if>
                                </span>
                            </f:if>
                        </div>

                        <f:if condition="{jobpost.hiringOrganization.phone}">
                            <span itemprop="telephone">
                                <a href="tel:{jobpost.hiringOrganization.phone->ttaddr:removeSpaces()}">{jobpost.hiringOrganization.phone}</a>
                            </span>
                        </f:if>

                        <f:if condition="{jobpost.hiringOrganization.email}">
                            <span itemprop="email">
                                <f:link.email email="{jobpost.hiringOrganization.email}">{jobpost.hiringOrganization.email}</f:link.email>
                            </span>
                        </f:if>
                    </div>
                </f:if>
            </div>
        </f:then>
        <f:else>
            <p>No job found!</p>
        </f:else>
    </f:if>

    <f:link.action action="list">Back to list</f:link.action>
</f:section>

</html>
